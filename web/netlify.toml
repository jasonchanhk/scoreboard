[build]
  base = "web"
  command = "npm run build"
  publish = "dist"

# Netlify Functions:
# - Regular Functions: netlify/functions/ (Node.js runtime)
#   - scoreboard-meta.js: Serves HTML with meta tags for /scoreboard/:id/view
# - Edge Functions: netlify/edge-functions/ (Deno runtime, runs at edge)
#   - og-image.ts: Generates preview images using og_edge (better for images)

# Route scoreboard view URLs to the function for crawler detection
# The function will serve HTML with meta tags for crawlers, or let browsers through to SPA
# This must come BEFORE the catch-all redirect
[[redirects]]
  from = "/scoreboard/:id/view"
  to = "/.netlify/functions/scoreboard-meta?id=:id"
  status = 200
  force = true

# All other routes go to SPA (this must come AFTER the scoreboard redirect)
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
